<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>{{ config.APP_NAME }}{% block title %}{% endblock %}</title>
    <link rel="icon" href="{{ url_for('static', filename='img/favicon.ico') }}" type="image/x-icon">

    {% if config.STATIC_BUNDLES %}
      {% set app_css = config.STATIC_MANIFEST['css'].get('app-shell') %}
      {% set runtime_js = config.STATIC_MANIFEST['js'].get('app-runtime') %}
    {% endif %}

    {% if app_css %}
      <link rel="stylesheet" href="{{ url_for('static', filename=app_css) }}">
    {% else %}
      <link rel="stylesheet" href="{{ url_for('static', filename='css/main.css') }}">
      <link rel="stylesheet" href="{{ url_for('static', filename='css/chat.css') }}">
      <link rel="stylesheet" href="{{ url_for('static', filename='css/header.css') }}">
      <link rel="stylesheet" href="{{ url_for('static', filename='css/search.css') }}">
      <link rel="stylesheet" href="{{ url_for('static', filename='css/profile.css') }}">
      <link rel="stylesheet" href="{{ url_for('static', filename='css/markdown.css') }}">
      <link rel="stylesheet" href="{{ url_for('static', filename='css/meta-chips.css') }}">
      <link rel="stylesheet" href="{{ url_for('static', filename='css/calendar.css') }}">
    {% endif %}

    {% if runtime_js %}
      <script type="module" defer src="{{ url_for('static', filename=runtime_js) }}"></script>
    {% else %}
      <script defer type="module" src="{{ url_for('static', filename='js/runtime/loader.js') }}"></script>
    {% endif %}

    {% block head_extra %}{% endblock %}
  </head>
  <body
    hx-ext="response-targets"
    hx-target-5*="#errors"
    hx-target-4*="#errors"
    hx-on::after-settle="window.appRuntime?.rehydrate(event)"
    data-csrf-token="{{ csrf_token() }}">

    <div id="errors" role="alert" aria-live="assertive" aria-atomic="true" hx-swap="beforeend"></div>
    <header id="app-header">
      {% block header %}{% endblock %}
    </header>

    <div class="app-container">
      {% block content %}{% endblock %}
    </div>

    {% block body_scripts %}{% endblock %}
  </body>
</html>
