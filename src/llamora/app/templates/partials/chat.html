<main
  id="content-wrapper"
  {% if oob %} hx-swap-oob="true" {% endif %}>
  <chat-view{% if request.headers.get('HX-Request') == 'true' %} data-rendering="true"{% endif %}{% if scroll_target %} data-scroll-target="{{ scroll_target }}"{% endif %}
             data-view-kind="{{ view_kind }}"
             aria-busy="{{ 'true' if request.headers.get('HX-Request') == 'true' else 'false' }}">
    {% include 'partials/history.html' %}
    {% if is_today %}
    <chat-form data-date="{{ day }}">
      <form id="message-form"
            hx-post="{{ url_for('chat.send_message', date=day) }}"
            hx-target="#chat"
            hx-on::after-request="this.reset()"
            hx-swap="beforeend">
        <div class="input-wrapper">
          <label class="visually-hidden" for="chat-message">Message for {{ day|long_date }}</label>
          <textarea class="input"
                    id="chat-message"
                    name="message"
                    rows="3"
                    placeholder="{{ 'Write your thoughts hereâ€¦' if is_today else 'This day has passed.' }}"
                    cols="40"
                    maxlength="{{ config.MAX_MESSAGE_LENGTH }}"></textarea>
          <input type="hidden" name="user_time" id="user-time" />
          <button id="send-btn" class="btn" type="submit" aria-label="Send"{% if not is_today %} disabled{% endif %}>
            <span class="icon-mask icon-feather send-icon" aria-hidden="true"></span>
          </button>
        </div>
      </form>
    </chat-form>

    {% else %}
    <div class="return-today" role="group" aria-label="Archived day divider">
      <div class="return-today__divider" aria-hidden="true">
        <span class="return-today__line return-today__line--left"></span>
        <span class="return-today__date">{{ day|long_date }}</span>
        <span class="return-today__line return-today__line--right"></span>
      </div>
      <p class="return-today__copy">This moment has settled into memory.</p>
      <a
        class="return-today__action"
        href="{{ url_for('days.day_today') }}"
        hx-get="{{ url_for('chat.chat_htmx_today') }}"
        hx-target="#content-wrapper"
        hx-swap="outerHTML"
        hx-push-url="true">
        Return to the present
      </a>
    </div>
    {% endif %}

    <scroll-bottom-button></scroll-bottom-button>
  </chat-view>
</main>
