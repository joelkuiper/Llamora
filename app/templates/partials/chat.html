<main
  id="content-wrapper"
  {% if oob %} hx-swap-oob="true" {% endif %}>
  {% include 'partials/history.html' %}
  {% if is_today %}
  <form id="message-form"
        hx-post="{{ url_for('chat.send_message', date=day) }}"
        hx-target="#chat"
        hx-on::after-request="this.reset()"
        hx-swap="beforeend">
    <div class="input-wrapper">
        <textarea class="input"
          name="message"
          rows="3"
          placeholder="{{ 'Write your thoughts hereâ€¦' if is_today else 'This day has past.' }}"
          cols="40"
          maxlength="{{ config.MAX_MESSAGE_LENGTH }}"></textarea>
        <button id="send-btn" class="btn" type="submit" aria-label="Send"{% if not is_today %} disabled{% endif %}></button>
      </div>
  </form>

  {% else %}
  <div class="return-today">This day has past.
    <a
    href="{{ url_for('days.day_today') }}"
       hx-get="{{ url_for('chat.chat_htmx_today') }}"
       hx-target="#content-wrapper"
       hx-swap="outerHTML"
       hx-push-url="true">
      Return to present. </a>
  {% endif %}
  <div id="scroll-bottom-container">
    <button id="scroll-bottom" class="scroll-btn" aria-label="Scroll to bottom">
      <svg width="100%" height="100%" viewBox="0 0 24 24"
           fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M8 12L12 16M12 16L16 12M12 16V8"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"/>
      </svg>
    </button>
  </div>

  <script type="module">
    import { initChatUI } from "{{ url_for('static', filename='js/chat.js') }}";
    import { updateActiveDay, initDayNav } from "{{ url_for('static', filename='js/day.js') }}";
    import { initSearchUI, scrollToHighlight } from "{{ url_for('static', filename='js/ui.js') }}";

    const run = () => {
      initChatUI();
      updateActiveDay();
      initDayNav();
      initSearchUI();
      scrollToHighlight();
      document.title = "{{ day }}";
    };

    run();
    window.addEventListener('pageshow', (event) => {
      if (event.persisted) run();
    });
  </script>
</main>
